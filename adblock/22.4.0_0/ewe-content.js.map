{"version":3,"sources":["webpack://@eyeo/webext-sdk/./node_modules/adblockpluscore/lib/common.js","webpack://@eyeo/webext-sdk/./node_modules/adblockpluscore/lib/content/elemHideEmulation.js","webpack://@eyeo/webext-sdk/./node_modules/adblockpluscore/lib/patterns.js","webpack://@eyeo/webext-sdk/./node_modules/webextension-polyfill/dist/browser-polyfill.js","webpack://@eyeo/webext-sdk/webpack/bootstrap","webpack://@eyeo/webext-sdk/./sdk/errors.js","webpack://@eyeo/webext-sdk/./sdk/content/element-collapsing.js","webpack://@eyeo/webext-sdk/./sdk/content/allowlisting.js","webpack://@eyeo/webext-sdk/./sdk/content/element-hiding-tracer.js","webpack://@eyeo/webext-sdk/./sdk/content/index.js","webpack://@eyeo/webext-sdk/./sdk/content/subscribe-links.js"],"names":["textToRegExp","exports","text","replace","regexpRegexp","makeRegExpParameter","source","flags","exec","RegExp","e","splitSelector","selector","includes","selectors","start","level","sep","i","length","chr","Math","max","push","substring","findTargetSelectorIndex","index","whitespace","scope","character","reverse","currentScope","pop","test","qualifySelector","qualifier","qualifiedSelector","qualifierTargetSelectorIndex","qualifierType","sub","trim","type","rest","filterToRegExp","minInvocationInterval","maxSynchronousProcessingTime","abpSelectorRegexp","testInfo","newIdleDeadline","startTime","performance","now","didTimeout","elapsed","remaining","yieldThread","Promise","resolve","requestIdleCallback","setTimeout","getCachedPropertyValue","object","name","defaultValueFunc","value","Object","defineProperty","makeSelector","node","parentElement","newSelector","idx","child","parentNode","children","positionInParent","tagName","stringifyStyle","rule","styles","style","property","item","getPropertyValue","priority","getPropertyPriority","sort","join","subSelectors","selectorText","scopeSupported","scopedQuerySelector","subtree","all","querySelectorAll","querySelector","elements","tryQuerySelector","scopedQuerySelectorAll","PlainSelector","this","_selector","maybeDependsOnAttributes","maybeContainsSiblingCombinators","prefix","targets","incompletePrefixRegexp","NotSelector","_innerPattern","Pattern","dependsOnStyles","dependsOnCharacterData","element","getElements","some","target","contains","lastProcessedElements","add","matches","setStyles","HasSelector","evaluate","XPathSelector","textContent","evaluator","XPathEvaluator","_expression","createExpression","ORDERED_NODE_SNAPSHOT_TYPE","flag","XPathResult","parent","result","snapshotLength","snapshotItem","ContainsSelector","_regexp","lastRoot","PropsSelector","propertyExpression","regexpString","slice","_subSelectors","subSelector","startsWith","lastIndexOf","mutationTypes","mutationTypeMatchMap","Map","mutationType","get","evaluateInner","currentSubtree","getSelectors","targetFilter","selectorGenerator","filterPatterns","patterns","stylesheets","mutations","types","Set","mutation","size","extractMutationTypes","filter","pattern","matchesMutationTypes","shouldObserveCharacterData","shouldObserveStyles","hideElemsFunc","unhideElemsFunc","_filteringInProgress","_nextFilteringScheduled","_lastInvocation","_scheduledProcessing","document","observer","MutationObserver","observe","bind","hiddenElements","stylesheet","URL","href","origin","location","match","content","startIndex","parens","quote","c","end","parseSelectorContent","console","warn","SyntaxError","hasSelectors","parseSelector","message","notSelectors","every","s","suffix","cssStyles","isSameOrigin","rules","cssRules","STYLE_RULE","clear","deadline","_refreshPatternStyles","patternsToCheck","addedNodes","removedNodes","extractMutationTargets","elementsToHide","elementFilters","elementsToUnhide","evaluationTargets","generator","has","delete","timeRemaining","_hideElems","elem","isConnected","_unhideElems","Array","from","failedAssertions","params","_addSelectors","_scheduleNextFiltering","readyState","addEventListener","_processFiltering","once","_appendScheduledProcessing","allCssRules","_readCssRules","styleSheets","event","sheet","queueFiltering","attributeName","newValue","oldValue","display","assign","createElement","attributes","shouldObserveAttributes","childList","attributeOldValue","characterData","onLoad","separatorRegExp","extendedAnchorRegExp","keywordRegExp","allKeywordsRegExp","CompiledPatterns","caseSensitive","caseInsensitive","_caseSensitive","_caseInsensitive","request","lowerCaseHref","compilePatterns","filters","isArray","urlPattern","regexpSource","matchCase","caseSensitiveRegExp","caseInsensitiveRegExp","error","toLowerCase","isLiteralPattern","regexp","startsWithAnchor","startsWithExtendedAnchor","endsWithSeparator","endsWithAnchor","substr","indexOf","browser","getPrototypeOf","prototype","CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE","SEND_RESPONSE_DEPRECATION_WARNING","wrapAPIs","extensionAPIs","apiMetadata","keys","Error","DefaultWeakMap","WeakMap","constructor","createItem","items","super","key","set","isThenable","then","makeCallback","promise","metadata","callbackArgs","runtime","lastError","reject","singleCallbackArg","pluralizeArguments","numArgs","wrapAsyncFunction","args","minArgs","maxArgs","fallbackToNoCallback","cbError","noCallback","wrapMethod","method","wrapper","Proxy","apply","targetMethod","thisObj","call","hasOwnProperty","Function","wrapObject","wrappers","cache","create","handlers","proxyTarget","prop","receiver","configurable","enumerable","desc","Reflect","deleteProperty","wrapEvent","wrapperMap","addListener","listener","hasListener","removeListener","onRequestFinishedWrappers","req","wrappedReq","getContent","loggedSendResponseDeprecationWarning","onMessageWrappers","sender","sendResponse","wrappedSendResponse","didCallSendResponse","sendResponsePromise","response","stack","err","isResultThenable","sendPromisedResult","msg","__mozWebExtensionPolyfillReject__","catch","wrappedSendMessageCallback","reply","wrappedSendMessage","apiNamespaceObj","wrappedCb","sendMessage","staticWrappers","devtools","network","onRequestFinished","onMessage","onMessageExternal","tabs","settingMetadata","privacy","services","websites","chrome","id","module","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","ignoreNoConnectionError","collapsedSelectors","observers","getURLFromElement","localName","data","baseURI","currentSrc","src","hideElement","properties","setProperty","disconnect","attributeFilter","unhideElement","removeProperty","collapseElement","attr","getAttribute","CSS","escape","getSelectorForBlockedElement","hideInAboutBlankFrames","urls","frame","contentDocument","errorCount","eventProcessingInterval","eventQueue","async","allowlistDomain","CustomEvent","isEventTrusted","timestamp","detail","signature","processNextEvent","shift","dispatchEvent","Event","stopOneClickAllowlisting","stopProcessingInterval","onDomainAllowlistingRequest","setInterval","clearInterval","removeEventListener","ElementHidingTracer","trace","log","deferred","url","startElementCollapsing","tracer","tracedSelectors","emulatedPatterns","cssProperties","subscribeLinks","button","isTrusted","link","HTMLAnchorElement","queryString","protocol","host","pathname","search","title","param","split","parts","decodeURIComponent","preventDefault","stopPropagation","initContentFeatures"],"mappings":"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","file":"ewe-content.js","sourcesContent":["/*\n * This file is part of Adblock Plus <https://adblockplus.org/>,\n * Copyright (C) 2006-present eyeo GmbH\n *\n * Adblock Plus is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * Adblock Plus is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Adblock Plus.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/** @module */\n\n\"use strict\";\n\nlet textToRegExp =\n/**\n * Converts raw text into a regular expression string\n * @param {string} text the string to convert\n * @return {string} regular expression representation of the text\n * @package\n */\nexports.textToRegExp = text => text.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, \"\\\\$&\");\n\nconst regexpRegexp = /^\\/(.*)\\/([imu]*)$/;\n\n/**\n * Make a regular expression from a text argument.\n *\n * If it can be parsed as a regular expression, parse it and the flags.\n *\n * @param {string} text the text argument.\n *\n * @return {?RegExp} a RegExp object or null in case of error.\n */\nexports.makeRegExpParameter = function makeRegExpParameter(text) {\n  let [, source, flags] = regexpRegexp.exec(text) || [null, textToRegExp(text)];\n\n  try {\n    return new RegExp(source, flags);\n  }\n  catch (e) {\n    return null;\n  }\n};\n\nlet splitSelector = exports.splitSelector = function splitSelector(selector) {\n  if (!selector.includes(\",\"))\n    return [selector];\n\n  let selectors = [];\n  let start = 0;\n  let level = 0;\n  let sep = \"\";\n\n  for (let i = 0; i < selector.length; i++) {\n    let chr = selector[i];\n\n    // ignore escaped characters\n    if (chr == \"\\\\\") {\n      i++;\n    }\n    // don't split within quoted text\n    else if (chr == sep) {\n      sep = \"\";             // e.g. [attr=\",\"]\n    }\n    else if (sep == \"\") {\n      if (chr == '\"' || chr == \"'\") {\n        sep = chr;\n      }\n      // don't split between parentheses\n      else if (chr == \"(\") {\n        level++;            // e.g. :matches(div,span)\n      }\n      else if (chr == \")\") {\n        level = Math.max(0, level - 1);\n      }\n      else if (chr == \",\" && level == 0) {\n        selectors.push(selector.substring(start, i));\n        start = i + 1;\n      }\n    }\n  }\n\n  selectors.push(selector.substring(start));\n  return selectors;\n};\n\nfunction findTargetSelectorIndex(selector) {\n  let index = 0;\n  let whitespace = 0;\n  let scope = [];\n\n  // Start from the end of the string and go character by character, where each\n  // character is a Unicode code point.\n  for (let character of [...selector].reverse()) {\n    let currentScope = scope[scope.length - 1];\n\n    if (character == \"'\" || character == \"\\\"\") {\n      // If we're already within the same type of quote, close the scope;\n      // otherwise open a new scope.\n      if (currentScope == character)\n        scope.pop();\n      else\n        scope.push(character);\n    }\n    else if (character == \"]\" || character == \")\") {\n      // For closing brackets and parentheses, open a new scope only if we're\n      // not within a quote. Within quotes these characters should have no\n      // meaning.\n      if (currentScope != \"'\" && currentScope != \"\\\"\")\n        scope.push(character);\n    }\n    else if (character == \"[\") {\n      // If we're already within a bracket, close the scope.\n      if (currentScope == \"]\")\n        scope.pop();\n    }\n    else if (character == \"(\") {\n      // If we're already within a parenthesis, close the scope.\n      if (currentScope == \")\")\n        scope.pop();\n    }\n    else if (!currentScope) {\n      // At the top level (not within any scope), count the whitespace if we've\n      // encountered it. Otherwise if we've hit one of the combinators,\n      // terminate here; otherwise if we've hit a non-colon character,\n      // terminate here.\n      if (/\\s/.test(character))\n        whitespace++;\n      else if ((character == \">\" || character == \"+\" || character == \"~\") ||\n               (whitespace > 0 && character != \":\"))\n        break;\n    }\n\n    // Zero out the whitespace count if we've entered a scope.\n    if (scope.length > 0)\n      whitespace = 0;\n\n    // Increment the index by the size of the character. Note that for Unicode\n    // composite characters (like emoji) this will be more than one.\n    index += character.length;\n  }\n\n  return selector.length - index + whitespace;\n}\n\n/**\n * Qualifies a CSS selector with a qualifier, which may be another CSS selector\n * or an empty string. For example, given the selector \"div.bar\" and the\n * qualifier \"#foo\", this function returns \"div#foo.bar\".\n * @param {string} selector The selector to qualify.\n * @param {string} qualifier The qualifier with which to qualify the selector.\n * @returns {string} The qualified selector.\n * @package\n */\nexports.qualifySelector = function qualifySelector(selector, qualifier) {\n  let qualifiedSelector = \"\";\n\n  let qualifierTargetSelectorIndex = findTargetSelectorIndex(qualifier);\n  let [, qualifierType = \"\"] =\n    /^([a-z][a-z-]*)?/i.exec(qualifier.substring(qualifierTargetSelectorIndex));\n\n  for (let sub of splitSelector(selector)) {\n    sub = sub.trim();\n\n    qualifiedSelector += \", \";\n\n    let index = findTargetSelectorIndex(sub);\n\n    // Note that the first group in the regular expression is optional. If it\n    // doesn't match (e.g. \"#foo::nth-child(1)\"), type will be an empty string.\n    let [, type = \"\", rest] =\n      /^([a-z][a-z-]*)?\\*?(.*)/i.exec(sub.substring(index));\n\n    if (type == qualifierType)\n      type = \"\";\n\n    // If the qualifier ends in a combinator (e.g. \"body #foo>\"), we put the\n    // type and the rest of the selector after the qualifier\n    // (e.g. \"body #foo>div.bar\"); otherwise (e.g. \"body #foo\") we merge the\n    // type into the qualifier (e.g. \"body div#foo.bar\").\n    if (/[\\s>+~]$/.test(qualifier))\n      qualifiedSelector += sub.substring(0, index) + qualifier + type + rest;\n    else\n      qualifiedSelector += sub.substring(0, index) + type + qualifier + rest;\n  }\n\n  // Remove the initial comma and space.\n  return qualifiedSelector.substring(2);\n};\n","/*\n * This file is part of Adblock Plus <https://adblockplus.org/>,\n * Copyright (C) 2006-present eyeo GmbH\n *\n * Adblock Plus is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * Adblock Plus is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Adblock Plus.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/** @module */\n\n\"use strict\";\n\nconst {makeRegExpParameter, splitSelector,\n       qualifySelector} = require(\"../common\");\nconst {filterToRegExp} = require(\"../patterns\");\n\nconst DEFAULT_MIN_INVOCATION_INTERVAL = 3000;\nlet minInvocationInterval = DEFAULT_MIN_INVOCATION_INTERVAL;\nconst DEFAULT_MAX_SYCHRONOUS_PROCESSING_TIME = 50;\nlet maxSynchronousProcessingTime = DEFAULT_MAX_SYCHRONOUS_PROCESSING_TIME;\n\nlet abpSelectorRegexp = /:(-abp-[\\w-]+|has|has-text|xpath|not)\\(/;\n\nlet testInfo = null;\n\nfunction toCSSStyleDeclaration(value) {\n  return Object.assign(document.createElement(\"test\"), {style: value}).style;\n}\n\n/**\n * Enables test mode, which tracks additional metadata about the inner\n * workings for test purposes. This also allows overriding internal\n * configuration.\n *\n * @param {object} options\n * @param {number} options.minInvocationInterval Overrides how long\n *   must be waited between filter processing runs\n * @param {number} options.maxSynchronousProcessingTime Overrides how\n *   long the thread may spend processing filters before it must yield\n *   its thread\n */\nexports.setTestMode = function setTestMode(options) {\n  if (typeof options.minInvocationInterval !== \"undefined\")\n    minInvocationInterval = options.minInvocationInterval;\n  if (typeof options.maxSynchronousProcessingTime !== \"undefined\")\n    maxSynchronousProcessingTime = options.maxSynchronousProcessingTime;\n\n  testInfo = {\n    lastProcessedElements: new Set(),\n    failedAssertions: []\n  };\n};\n\nexports.getTestInfo = function getTestInfo() {\n  return testInfo;\n};\n\nexports.clearTestMode = function() {\n  minInvocationInterval = DEFAULT_MIN_INVOCATION_INTERVAL;\n  maxSynchronousProcessingTime = DEFAULT_MAX_SYCHRONOUS_PROCESSING_TIME;\n  testInfo = null;\n};\n\n/**\n * Creates a new IdleDeadline.\n *\n * Note: This function is synchronous and does NOT request an idle\n * callback.\n *\n * See {@link https://developer.mozilla.org/en-US/docs/Web/API/IdleDeadline}.\n * @return {IdleDeadline}\n */\nfunction newIdleDeadline() {\n  let startTime = performance.now();\n  return {\n    didTimeout: false,\n    timeRemaining() {\n      let elapsed = performance.now() - startTime;\n      let remaining = maxSynchronousProcessingTime - elapsed;\n      return Math.max(0, remaining);\n    }\n  };\n}\n\n/**\n * Returns a promise that is resolved when the browser is next idle.\n *\n * This is intended to be used for long running tasks on the UI thread\n * to allow other UI events to process.\n *\n * @return {Promise.<IdleDeadline>}\n *    A promise that is fulfilled when you can continue processing\n */\nfunction yieldThread() {\n  return new Promise(resolve => {\n    if (typeof requestIdleCallback === \"function\") {\n      requestIdleCallback(resolve);\n    }\n    else {\n      setTimeout(() => {\n        resolve(newIdleDeadline());\n      }, 0);\n    }\n  });\n}\n\n\nfunction getCachedPropertyValue(object, name, defaultValueFunc = () => {}) {\n  let value = object[name];\n  if (typeof value == \"undefined\")\n    Object.defineProperty(object, name, {value: value = defaultValueFunc()});\n  return value;\n}\n\n/**\n * Return position of node from parent.\n * @param {Node} node the node to find the position of.\n * @return {number} One-based index like for :nth-child(), or 0 on error.\n */\nfunction positionInParent(node) {\n  let index = 0;\n  for (let child of node.parentNode.children) {\n    if (child == node)\n      return index + 1;\n\n    index++;\n  }\n\n  return 0;\n}\n\nfunction makeSelector(node, selector = \"\") {\n  if (node == null)\n    return null;\n  if (!node.parentElement) {\n    let newSelector = \":root\";\n    if (selector)\n      newSelector += \" > \" + selector;\n    return newSelector;\n  }\n  let idx = positionInParent(node);\n  if (idx > 0) {\n    let newSelector = `${node.tagName}:nth-child(${idx})`;\n    if (selector)\n      newSelector += \" > \" + selector;\n    return makeSelector(node.parentElement, newSelector);\n  }\n\n  return selector;\n}\n\nfunction parseSelectorContent(content, startIndex) {\n  let parens = 1;\n  let quote = null;\n  let i = startIndex;\n  for (; i < content.length; i++) {\n    let c = content[i];\n    if (c == \"\\\\\") {\n      // Ignore escaped characters\n      i++;\n    }\n    else if (quote) {\n      if (c == quote)\n        quote = null;\n    }\n    else if (c == \"'\" || c == '\"') {\n      quote = c;\n    }\n    else if (c == \"(\") {\n      parens++;\n    }\n    else if (c == \")\") {\n      parens--;\n      if (parens == 0)\n        break;\n    }\n  }\n\n  if (parens > 0)\n    return null;\n  return {text: content.substring(startIndex, i), end: i};\n}\n\n/**\n * Stringified style objects\n * @typedef {Object} StringifiedStyle\n * @property {string} style CSS style represented by a string.\n * @property {string[]} subSelectors selectors the CSS properties apply to.\n */\n\n/**\n * Produce a string representation of the stylesheet entry.\n * @param {CSSStyleRule} rule the CSS style rule.\n * @return {StringifiedStyle} the stringified style.\n */\nfunction stringifyStyle(rule) {\n  let styles = [];\n  for (let i = 0; i < rule.style.length; i++) {\n    let property = rule.style.item(i);\n    let value = rule.style.getPropertyValue(property);\n    let priority = rule.style.getPropertyPriority(property);\n    styles.push(`${property}: ${value}${priority ? \" !\" + priority : \"\"};`);\n  }\n  styles.sort();\n  return {\n    style: styles.join(\" \"),\n    subSelectors: splitSelector(rule.selectorText)\n  };\n}\n\nlet scopeSupported = null;\n\nfunction tryQuerySelector(subtree, selector, all) {\n  let elements = null;\n  try {\n    elements = all ? subtree.querySelectorAll(selector) :\n      subtree.querySelector(selector);\n    scopeSupported = true;\n  }\n  catch (e) {\n    // Edge doesn't support \":scope\"\n    scopeSupported = false;\n  }\n  return elements;\n}\n\n/**\n * Query selector.\n *\n * If it is relative, will try :scope.\n *\n * @param {Node} subtree the element to query selector\n * @param {string} selector the selector to query\n * @param {bool} [all=false] true to perform querySelectorAll()\n *\n * @returns {?(Node|NodeList)} result of the query. null in case of error.\n */\nfunction scopedQuerySelector(subtree, selector, all) {\n  if (selector[0] == \">\") {\n    selector = \":scope\" + selector;\n    if (scopeSupported) {\n      return all ? subtree.querySelectorAll(selector) :\n        subtree.querySelector(selector);\n    }\n    if (scopeSupported == null)\n      return tryQuerySelector(subtree, selector, all);\n    return null;\n  }\n  return all ? subtree.querySelectorAll(selector) :\n    subtree.querySelector(selector);\n}\n\nfunction scopedQuerySelectorAll(subtree, selector) {\n  return scopedQuerySelector(subtree, selector, true);\n}\n\nclass PlainSelector {\n  constructor(selector) {\n    this._selector = selector;\n    this.maybeDependsOnAttributes = /[#.:]|\\[.+\\]/.test(selector);\n    this.maybeContainsSiblingCombinators = /[~+]/.test(selector);\n  }\n\n  /**\n   * Generator function returning a pair of selector string and subtree.\n   * @param {string} prefix the prefix for the selector.\n   * @param {Node} subtree the subtree we work on.\n   * @param {Node[]} [targets] the nodes we are interested in.\n   */\n  *getSelectors(prefix, subtree, targets) {\n    yield [prefix + this._selector, subtree];\n  }\n}\n\nconst incompletePrefixRegexp = /[\\s>+~]$/;\n\nclass NotSelector {\n  constructor(selectors) {\n    this._innerPattern = new Pattern(selectors);\n  }\n\n  get dependsOnStyles() {\n    return this._innerPattern.dependsOnStyles;\n  }\n\n  get dependsOnCharacterData() {\n    return this._innerPattern.dependsOnCharacterData;\n  }\n\n  get maybeDependsOnAttributes() {\n    return this._innerPattern.maybeDependsOnAttributes;\n  }\n\n  *getSelectors(prefix, subtree, targets) {\n    for (let element of this.getElements(prefix, subtree, targets))\n      yield [makeSelector(element), element];\n  }\n\n  /**\n   * Generator function returning selected elements.\n   * @param {string} prefix the prefix for the selector.\n   * @param {Node} subtree the subtree we work on.\n   * @param {Node[]} [targets] the nodes we are interested in.\n   */\n  *getElements(prefix, subtree, targets) {\n    let actualPrefix = (!prefix || incompletePrefixRegexp.test(prefix)) ?\n      prefix + \"*\" : prefix;\n    let elements = scopedQuerySelectorAll(subtree, actualPrefix);\n    if (elements) {\n      for (let element of elements) {\n        // If the element is neither an ancestor nor a descendant of one of the\n        // targets, we can skip it.\n        if (targets && !targets.some(target => element.contains(target) ||\n                                               target.contains(element))) {\n          yield null;\n          continue;\n        }\n\n        if (testInfo)\n          testInfo.lastProcessedElements.add(element);\n\n        if (!this._innerPattern.matches(element, subtree))\n          yield element;\n\n        yield null;\n      }\n    }\n  }\n\n  setStyles(styles) {\n    this._innerPattern.setStyles(styles);\n  }\n}\n\nclass HasSelector {\n  constructor(selectors) {\n    this._innerPattern = new Pattern(selectors);\n  }\n\n  get dependsOnStyles() {\n    return this._innerPattern.dependsOnStyles;\n  }\n\n  get dependsOnCharacterData() {\n    return this._innerPattern.dependsOnCharacterData;\n  }\n\n  get maybeDependsOnAttributes() {\n    return this._innerPattern.maybeDependsOnAttributes;\n  }\n\n  *getSelectors(prefix, subtree, targets) {\n    for (let element of this.getElements(prefix, subtree, targets))\n      yield [makeSelector(element), element];\n  }\n\n  /**\n   * Generator function returning selected elements.\n   * @param {string} prefix the prefix for the selector.\n   * @param {Node} subtree the subtree we work on.\n   * @param {Node[]} [targets] the nodes we are interested in.\n   */\n  *getElements(prefix, subtree, targets) {\n    let actualPrefix = (!prefix || incompletePrefixRegexp.test(prefix)) ?\n      prefix + \"*\" : prefix;\n    let elements = scopedQuerySelectorAll(subtree, actualPrefix);\n    if (elements) {\n      for (let element of elements) {\n        // If the element is neither an ancestor nor a descendant of one of the\n        // targets, we can skip it.\n        if (targets && !targets.some(target => element.contains(target) ||\n                                               target.contains(element))) {\n          yield null;\n          continue;\n        }\n\n        if (testInfo)\n          testInfo.lastProcessedElements.add(element);\n\n        for (let selector of this._innerPattern.evaluate(element, targets)) {\n          if (selector == null)\n            yield null;\n          else if (scopedQuerySelector(element, selector))\n            yield element;\n        }\n\n        yield null;\n      }\n    }\n  }\n\n  setStyles(styles) {\n    this._innerPattern.setStyles(styles);\n  }\n}\n\nclass XPathSelector {\n  constructor(textContent) {\n    this.dependsOnCharacterData = true;\n    this.maybeDependsOnAttributes = true;\n\n    let evaluator = new XPathEvaluator();\n    this._expression = evaluator.createExpression(textContent, null);\n  }\n\n  *getSelectors(prefix, subtree, targets) {\n    for (let element of this.getElements(prefix, subtree, targets))\n      yield [makeSelector(element), element];\n  }\n\n  *getElements(prefix, subtree, targets) {\n    let {ORDERED_NODE_SNAPSHOT_TYPE: flag} = XPathResult;\n    let elements = prefix ? scopedQuerySelectorAll(subtree, prefix) : [subtree];\n    for (let parent of elements) {\n      let result = this._expression.evaluate(parent, flag, null);\n      for (let i = 0, {snapshotLength} = result; i < snapshotLength; i++)\n        yield result.snapshotItem(i);\n    }\n  }\n}\n\nclass ContainsSelector {\n  constructor(textContent) {\n    this.dependsOnCharacterData = true;\n\n    this._regexp = makeRegExpParameter(textContent);\n  }\n\n  *getSelectors(prefix, subtree, targets) {\n    for (let element of this.getElements(prefix, subtree, targets))\n      yield [makeSelector(element), subtree];\n  }\n\n  *getElements(prefix, subtree, targets) {\n    let actualPrefix = (!prefix || incompletePrefixRegexp.test(prefix)) ?\n      prefix + \"*\" : prefix;\n\n    let elements = scopedQuerySelectorAll(subtree, actualPrefix);\n\n    if (elements) {\n      let lastRoot = null;\n      for (let element of elements) {\n        // For a filter like div:-abp-contains(Hello) and a subtree like\n        // <div id=\"a\"><div id=\"b\"><div id=\"c\">Hello</div></div></div>\n        // we're only interested in div#a\n        if (lastRoot && lastRoot.contains(element)) {\n          yield null;\n          continue;\n        }\n\n        lastRoot = element;\n\n        if (targets && !targets.some(target => element.contains(target) ||\n                                               target.contains(element))) {\n          yield null;\n          continue;\n        }\n\n        if (testInfo)\n          testInfo.lastProcessedElements.add(element);\n\n        if (this._regexp && this._regexp.test(element.textContent))\n          yield element;\n        else\n          yield null;\n      }\n    }\n  }\n}\n\nclass PropsSelector {\n  constructor(propertyExpression) {\n    this.dependsOnStyles = true;\n    this.maybeDependsOnAttributes = true;\n\n    let regexpString;\n    if (propertyExpression.length >= 2 && propertyExpression[0] == \"/\" &&\n        propertyExpression[propertyExpression.length - 1] == \"/\")\n      regexpString = propertyExpression.slice(1, -1);\n    else\n      regexpString = filterToRegExp(propertyExpression);\n\n    this._regexp = new RegExp(regexpString, \"i\");\n\n    this._subSelectors = [];\n  }\n\n  *getSelectors(prefix, subtree, targets) {\n    for (let subSelector of this._subSelectors) {\n      if (subSelector.startsWith(\"*\") &&\n          !incompletePrefixRegexp.test(prefix))\n        subSelector = subSelector.substring(1);\n\n      yield [qualifySelector(subSelector, prefix), subtree];\n    }\n  }\n\n  setStyles(styles) {\n    this._subSelectors = [];\n    for (let style of styles) {\n      if (this._regexp.test(style.style)) {\n        for (let subSelector of style.subSelectors) {\n          let idx = subSelector.lastIndexOf(\"::\");\n          if (idx != -1)\n            subSelector = subSelector.substring(0, idx);\n\n          this._subSelectors.push(subSelector);\n        }\n      }\n    }\n  }\n}\n\nclass Pattern {\n  constructor(selectors, text) {\n    this.selectors = selectors;\n    this.text = text;\n  }\n\n  get dependsOnStyles() {\n    return getCachedPropertyValue(\n      this, \"_dependsOnStyles\", () => this.selectors.some(\n        selector => selector.dependsOnStyles\n      )\n    );\n  }\n\n  get maybeDependsOnAttributes() {\n    // Observe changes to attributes if either there's a plain selector that\n    // looks like an ID selector, class selector, or attribute selector in one\n    // of the patterns (e.g. \"a[href='https://example.com/']\")\n    // or there's a properties selector nested inside a has selector\n    // (e.g. \"div:-abp-has(:-abp-properties(color: blue))\")\n    return getCachedPropertyValue(\n      this, \"_maybeDependsOnAttributes\", () => this.selectors.some(\n        selector => selector.maybeDependsOnAttributes ||\n                    (selector instanceof HasSelector &&\n                     selector.dependsOnStyles)\n      )\n    );\n  }\n\n  get dependsOnCharacterData() {\n    // Observe changes to character data only if there's a contains selector in\n    // one of the patterns.\n    return getCachedPropertyValue(\n      this, \"_dependsOnCharacterData\", () => this.selectors.some(\n        selector => selector.dependsOnCharacterData\n      )\n    );\n  }\n\n  get maybeContainsSiblingCombinators() {\n    return getCachedPropertyValue(\n      this, \"_maybeContainsSiblingCombinators\", () => this.selectors.some(\n        selector => selector.maybeContainsSiblingCombinators\n      )\n    );\n  }\n\n  matchesMutationTypes(mutationTypes) {\n    let mutationTypeMatchMap = getCachedPropertyValue(\n      this, \"_mutationTypeMatchMap\", () => new Map([\n        // All types of DOM-dependent patterns are affected by mutations of\n        // type \"childList\".\n        [\"childList\", true],\n        [\"attributes\", this.maybeDependsOnAttributes],\n        [\"characterData\", this.dependsOnCharacterData]\n      ])\n    );\n\n    for (let mutationType of mutationTypes) {\n      if (mutationTypeMatchMap.get(mutationType))\n        return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Generator function returning CSS selectors for all elements that\n   * match the pattern.\n   *\n   * This allows transforming from selectors that may contain custom\n   * :-abp- selectors to pure CSS selectors that can be used to select\n   * elements.\n   *\n   * The selectors returned from this function may be invalidated by DOM\n   * mutations.\n   *\n   * @param {Node} subtree the subtree we work on\n   * @param {Node[]} [targets] the nodes we are interested in. May be\n   * used to optimize search.\n   */\n  *evaluate(subtree, targets) {\n    let selectors = this.selectors;\n    function* evaluateInner(index, prefix, currentSubtree) {\n      if (index >= selectors.length) {\n        yield prefix;\n        return;\n      }\n      for (let [selector, element] of selectors[index].getSelectors(\n        prefix, currentSubtree, targets\n      )) {\n        if (selector == null)\n          yield null;\n        else\n          yield* evaluateInner(index + 1, selector, element);\n      }\n      // Just in case the getSelectors() generator above had to run some heavy\n      // document.querySelectorAll() call which didn't produce any results, make\n      // sure there is at least one point where execution can pause.\n      yield null;\n    }\n    yield* evaluateInner(0, \"\", subtree);\n  }\n\n  /**\n   * Checks if a pattern matches a specific element\n   * @param {Node} [target] the element we're interested in checking for\n   * matches on.\n   * @param {Node} subtree the subtree we work on\n   * @return {bool}\n   */\n  matches(target, subtree) {\n    let targetFilter = [target];\n    if (this.maybeContainsSiblingCombinators)\n      targetFilter = null;\n\n    let selectorGenerator = this.evaluate(subtree, targetFilter);\n    for (let selector of selectorGenerator) {\n      if (selector && target.matches(selector))\n        return true;\n    }\n    return false;\n  }\n\n  setStyles(styles) {\n    for (let selector of this.selectors) {\n      if (selector.dependsOnStyles)\n        selector.setStyles(styles);\n    }\n  }\n}\n\nfunction extractMutationTypes(mutations) {\n  let types = new Set();\n\n  for (let mutation of mutations) {\n    types.add(mutation.type);\n\n    // There are only 3 types of mutations: \"attributes\", \"characterData\", and\n    // \"childList\".\n    if (types.size == 3)\n      break;\n  }\n\n  return types;\n}\n\nfunction extractMutationTargets(mutations) {\n  if (!mutations)\n    return null;\n\n  let targets = new Set();\n\n  for (let mutation of mutations) {\n    if (mutation.type == \"childList\") {\n      // When new nodes are added, we're interested in the added nodes rather\n      // than the parent.\n      for (let node of mutation.addedNodes)\n        targets.add(node);\n      if (mutation.removedNodes.length > 0)\n        targets.add(mutation.target);\n    }\n    else {\n      targets.add(mutation.target);\n    }\n  }\n\n  return [...targets];\n}\n\nfunction filterPatterns(patterns, {stylesheets, mutations}) {\n  if (!stylesheets && !mutations)\n    return patterns.slice();\n\n  let mutationTypes = mutations ? extractMutationTypes(mutations) : null;\n\n  return patterns.filter(\n    pattern => (stylesheets && pattern.dependsOnStyles) ||\n               (mutations && pattern.matchesMutationTypes(mutationTypes))\n  );\n}\n\nfunction shouldObserveAttributes(patterns) {\n  return patterns.some(pattern => pattern.maybeDependsOnAttributes);\n}\n\nfunction shouldObserveCharacterData(patterns) {\n  return patterns.some(pattern => pattern.dependsOnCharacterData);\n}\n\nfunction shouldObserveStyles(patterns) {\n  return patterns.some(pattern => pattern.dependsOnStyles);\n}\n\n/**\n * @callback hideElemsFunc\n * @param {Node[]} elements Elements on the page that should be hidden\n * @param {string[]} elementFilters\n *   The filter text that caused the elements to be hidden\n */\n\n/**\n * @callback unhideElemsFunc\n * @param {Node[]} elements Elements on the page that should be hidden\n */\n\n\n/**\n * Manages the front-end processing of element hiding emulation filters.\n */\nexports.ElemHideEmulation = class ElemHideEmulation {\n  /**\n   * @param {module:content/elemHideEmulation~hideElemsFunc} hideElemsFunc\n   *   A callback that should be provided to do the actual element hiding.\n   * @param {module:content/elemHideEmulation~unhideElemsFunc} unhideElemsFunc\n   *   A callback that should be provided to unhide previously hidden elements.\n   */\n  constructor(hideElemsFunc = () => {}, unhideElemsFunc = () => {}) {\n    this._filteringInProgress = false;\n    this._nextFilteringScheduled = false;\n    this._lastInvocation = -minInvocationInterval;\n    this._scheduledProcessing = null;\n\n    this.document = document;\n    this.hideElemsFunc = hideElemsFunc;\n    this.unhideElemsFunc = unhideElemsFunc;\n    this.observer = new MutationObserver(this.observe.bind(this));\n    this.hiddenElements = new Set();\n  }\n\n  isSameOrigin(stylesheet) {\n    try {\n      return new URL(stylesheet.href).origin == this.document.location.origin;\n    }\n    catch (e) {\n      // Invalid URL, assume that it is first-party.\n      return true;\n    }\n  }\n\n  /**\n   * Parse the selector\n   * @param {string} selector the selector to parse\n   * @return {Array} selectors is an array of objects,\n   * or null in case of errors.\n   */\n  parseSelector(selector) {\n    if (selector.length == 0)\n      return [];\n\n    let match = abpSelectorRegexp.exec(selector);\n    if (!match)\n      return [new PlainSelector(selector)];\n\n    let selectors = [];\n    if (match.index > 0)\n      selectors.push(new PlainSelector(selector.substring(0, match.index)));\n\n    let startIndex = match.index + match[0].length;\n    let content = parseSelectorContent(selector, startIndex);\n    if (!content) {\n      console.warn(new SyntaxError(\"Failed to parse Adblock Plus \" +\n                                   `selector ${selector} ` +\n                                   \"due to unmatched parentheses.\"));\n      return null;\n    }\n    if (match[1] == \"-abp-properties\") {\n      selectors.push(new PropsSelector(content.text));\n    }\n    else if (match[1] == \"-abp-has\" || match[1] == \"has\") {\n      let hasSelectors = this.parseSelector(content.text);\n      if (hasSelectors == null)\n        return null;\n      selectors.push(new HasSelector(hasSelectors));\n    }\n    else if (match[1] == \"-abp-contains\" || match[1] == \"has-text\") {\n      selectors.push(new ContainsSelector(content.text));\n    }\n    else if (match[1] === \"xpath\") {\n      try {\n        selectors.push(new XPathSelector(content.text));\n      }\n      catch ({message}) {\n        console.warn(\n          new SyntaxError(\n            \"Failed to parse Adblock Plus \" +\n            `selector ${selector}, invalid ` +\n            `xpath: ${content.text} ` +\n            `error: ${message}.`\n          )\n        );\n\n        return null;\n      }\n    }\n    else if (match[1] == \"not\") {\n      let notSelectors = this.parseSelector(content.text);\n      if (notSelectors == null)\n        return null;\n\n      // if all of the inner selectors are PlainSelectors, then we\n      // don't actually need to use our selector at all. We're better\n      // off delegating to the browser :not implementation.\n      if (notSelectors.every(s => s instanceof PlainSelector))\n        selectors.push(new PlainSelector(`:not(${content.text})`));\n      else\n        selectors.push(new NotSelector(notSelectors));\n    }\n    else {\n      // this is an error, can't parse selector.\n      console.warn(new SyntaxError(\"Failed to parse Adblock Plus \" +\n                                   `selector ${selector}, invalid ` +\n                                   `pseudo-class :${match[1]}().`));\n      return null;\n    }\n\n    let suffix = this.parseSelector(selector.substring(content.end + 1));\n    if (suffix == null)\n      return null;\n\n    selectors.push(...suffix);\n\n    if (selectors.length == 1 && selectors[0] instanceof ContainsSelector) {\n      console.warn(new SyntaxError(\"Failed to parse Adblock Plus \" +\n                                   `selector ${selector}, can't ` +\n                                   \"have a lonely :-abp-contains().\"));\n      return null;\n    }\n    return selectors;\n  }\n\n  /**\n   * Reads the rules out of CSS stylesheets\n   * @param {CSSStyleSheet[]} [stylesheets] The list of stylesheets to\n   * read.\n   * @return {CSSStyleRule[]}\n   */\n  _readCssRules(stylesheets) {\n    let cssStyles = [];\n\n    for (let stylesheet of stylesheets || []) {\n      // Explicitly ignore third-party stylesheets to ensure consistent behavior\n      // between Firefox and Chrome.\n      if (!this.isSameOrigin(stylesheet))\n        continue;\n\n      let rules;\n      try {\n        rules = stylesheet.cssRules;\n      }\n      catch (e) {\n        // On Firefox, there is a chance that an InvalidAccessError\n        // get thrown when accessing cssRules. Just skip the stylesheet\n        // in that case.\n        // See https://searchfox.org/mozilla-central/rev/f65d7528e34ef1a7665b4a1a7b7cdb1388fcd3aa/layout/style/StyleSheet.cpp#699\n        continue;\n      }\n\n      if (!rules)\n        continue;\n\n      for (let rule of rules) {\n        if (rule.type != rule.STYLE_RULE)\n          continue;\n\n        cssStyles.push(stringifyStyle(rule));\n      }\n    }\n    return cssStyles;\n  }\n\n  /**\n   * Processes the current document and applies all rules to it.\n   * @param {CSSStyleSheet[]} [stylesheets]\n   *    The list of new stylesheets that have been added to the document and\n   *    made reprocessing necessary. This parameter shouldn't be passed in for\n   *    the initial processing, all of document's stylesheets will be considered\n   *    then and all rules, including the ones not dependent on styles.\n   * @param {MutationRecord[]} [mutations]\n   *    The list of DOM mutations that have been applied to the document and\n   *    made reprocessing necessary. This parameter shouldn't be passed in for\n   *    the initial processing, the entire document will be considered\n   *    then and all rules, including the ones not dependent on the DOM.\n   * @return {Promise}\n   *    A promise that is fulfilled once all filtering is completed\n   */\n  async _addSelectors(stylesheets, mutations) {\n    if (testInfo)\n      testInfo.lastProcessedElements.clear();\n\n    let deadline = newIdleDeadline();\n\n    if (shouldObserveStyles(this.patterns))\n      this._refreshPatternStyles();\n\n    let patternsToCheck = filterPatterns(\n      this.patterns, {stylesheets, mutations}\n    );\n\n    let targets = extractMutationTargets(mutations);\n\n    let elementsToHide = [];\n    let elementFilters = [];\n    let elementsToUnhide = new Set(this.hiddenElements);\n\n    for (let pattern of patternsToCheck) {\n      let evaluationTargets = targets;\n\n      // If the pattern appears to contain any sibling combinators, we can't\n      // easily optimize based on the mutation targets. Since this is a\n      // special case, skip the optimization. By setting it to null here we\n      // make sure we process the entire DOM.\n      if (pattern.maybeContainsSiblingCombinators)\n        evaluationTargets = null;\n\n      let generator = pattern.evaluate(this.document, evaluationTargets);\n      for (let selector of generator) {\n        if (selector != null) {\n          for (let element of this.document.querySelectorAll(selector)) {\n            if (!this.hiddenElements.has(element)) {\n              elementsToHide.push(element);\n              elementFilters.push(pattern.text);\n            }\n            else {\n              elementsToUnhide.delete(element);\n            }\n          }\n        }\n\n        if (deadline.timeRemaining() <= 0)\n          deadline = await yieldThread();\n      }\n    }\n    this._hideElems(elementsToHide, elementFilters);\n\n    // The search for elements to hide it optimized to find new things\n    // to hide quickly, by not checking all patterns and not checking\n    // the full DOM. That's why we need to do a more thorough check\n    // for each remaining element that might need to be unhidden,\n    // checking all patterns.\n    for (let elem of elementsToUnhide) {\n      if (!elem.isConnected) {\n        // elements that are no longer in the DOM should be unhidden\n        // in case they're ever readded, and then forgotten about so\n        // we don't cause a memory leak.\n        continue;\n      }\n      let matchesAny = this.patterns.some(pattern => pattern.matches(\n        elem, this.document\n      ));\n      if (matchesAny)\n        elementsToUnhide.delete(elem);\n\n      if (deadline.timeRemaining() <= 0)\n        deadline = await yieldThread();\n    }\n    this._unhideElems(Array.from(elementsToUnhide));\n  }\n\n  _hideElems(elementsToHide, elementFilters) {\n    if (elementsToHide.length > 0) {\n      this.hideElemsFunc(elementsToHide, elementFilters);\n      for (let elem of elementsToHide)\n        this.hiddenElements.add(elem);\n    }\n  }\n\n  _unhideElems(elementsToUnhide) {\n    if (elementsToUnhide.length > 0) {\n      this.unhideElemsFunc(elementsToUnhide);\n      for (let elem of elementsToUnhide)\n        this.hiddenElements.delete(elem);\n    }\n  }\n\n  /**\n   * Performed any scheduled processing.\n   *\n   * This function is asyncronous, and should not be run multiple\n   * times in parallel. The flag `_filteringInProgress` is set and\n   * unset so you can check if it's already running.\n   * @return {Promise}\n   *  A promise that is fulfilled once all filtering is completed\n   */\n  async _processFiltering() {\n    if (this._filteringInProgress) {\n      console.warn(\"ElemHideEmulation scheduling error: \" +\n                   \"Tried to process filtering in parallel.\");\n      if (testInfo) {\n        testInfo.failedAssertions.push(\n          \"Tried to process filtering in parallel\"\n        );\n      }\n      return;\n    }\n    let params = this._scheduledProcessing || {};\n    this._scheduledProcessing = null;\n    this._filteringInProgress = true;\n    this._nextFilteringScheduled = false;\n    await this._addSelectors(\n      params.stylesheets,\n      params.mutations\n    );\n    this._lastInvocation = performance.now();\n    this._filteringInProgress = false;\n    if (this._scheduledProcessing)\n      this._scheduleNextFiltering();\n  }\n\n  /**\n   * Appends new changes to the list of filters for the next time\n   * filtering is run.\n   * @param {CSSStyleSheet[]} [stylesheets]\n   *    new stylesheets to be processed. This parameter should be omitted\n   *    for full reprocessing.\n   * @param {MutationRecord[]} [mutations]\n   *    new DOM mutations to be processed. This parameter should be omitted\n   *    for full reprocessing.\n   */\n  _appendScheduledProcessing(stylesheets, mutations) {\n    if (!this._scheduledProcessing) {\n      // There isn't anything scheduled yet. Make the schedule.\n      this._scheduledProcessing = {stylesheets, mutations};\n    }\n    else if (!stylesheets && !mutations) {\n      // The new request was to reprocess everything, and so any\n      // previous filters are irrelevant.\n      this._scheduledProcessing = {};\n    }\n    else if (this._scheduledProcessing.stylesheets ||\n             this._scheduledProcessing.mutations) {\n      // The previous filters are not to filter everything, so the new\n      // parameters matter. Push them onto the appropriate lists.\n      if (stylesheets) {\n        if (!this._scheduledProcessing.stylesheets)\n          this._scheduledProcessing.stylesheets = [];\n        this._scheduledProcessing.stylesheets.push(...stylesheets);\n      }\n      if (mutations) {\n        if (!this._scheduledProcessing.mutations)\n          this._scheduledProcessing.mutations = [];\n        this._scheduledProcessing.mutations.push(...mutations);\n      }\n    }\n    else {\n      // this._scheduledProcessing is already going to recheck\n      // everything, so no need to do anything here.\n    }\n  }\n\n  /**\n   * Schedule filtering to be processed in the future, or start\n   * processing immediately.\n   *\n   * If processing is already scheduled, this does nothing.\n   */\n  _scheduleNextFiltering() {\n    if (this._nextFilteringScheduled || this._filteringInProgress) {\n      // The next one has already been scheduled. Our new events are\n      // on the queue, so nothing more to do.\n      return;\n    }\n\n    if (this.document.readyState === \"loading\") {\n      // Document isn't fully loaded yet, so schedule our first\n      // filtering as soon as that's done.\n      this.document.addEventListener(\n        \"DOMContentLoaded\",\n        () => this._processFiltering(),\n        {once: true}\n      );\n      this._nextFilteringScheduled = true;\n    }\n    else if (performance.now() - this._lastInvocation <\n             minInvocationInterval) {\n      // It hasn't been long enough since our last filter. Set the\n      // timeout for when it's time for that.\n      setTimeout(\n        () => this._processFiltering(),\n        minInvocationInterval - (performance.now() - this._lastInvocation)\n      );\n      this._nextFilteringScheduled = true;\n    }\n    else {\n      // We can actually just start filtering immediately!\n      this._processFiltering();\n    }\n  }\n\n  /**\n   * Re-run filtering either immediately or queued.\n   * @param {CSSStyleSheet[]} [stylesheets]\n   *    new stylesheets to be processed. This parameter should be omitted\n   *    for full reprocessing.\n   * @param {MutationRecord[]} [mutations]\n   *    new DOM mutations to be processed. This parameter should be omitted\n   *    for full reprocessing.\n   */\n  queueFiltering(stylesheets, mutations) {\n    this._appendScheduledProcessing(stylesheets, mutations);\n    this._scheduleNextFiltering();\n  }\n\n  _refreshPatternStyles(stylesheet) {\n    let allCssRules = this._readCssRules(this.document.styleSheets);\n    for (let pattern of this.patterns)\n      pattern.setStyles(allCssRules);\n  }\n\n  onLoad(event) {\n    let stylesheet = event.target.sheet;\n    if (stylesheet)\n      this.queueFiltering([stylesheet]);\n  }\n\n  observe(mutations) {\n    if (testInfo) {\n      // In test mode, filter out any mutations likely done by us\n      // (i.e. style=\"display: none !important\"). This makes it easier to\n      // observe how the code responds to DOM mutations.\n      mutations = mutations.filter(\n        ({type, attributeName, target: {style: newValue}, oldValue}) =>\n          !(type == \"attributes\" && attributeName == \"style\" &&\n            newValue.display == \"none\" &&\n            toCSSStyleDeclaration(oldValue).display != \"none\")\n      );\n\n      if (mutations.length == 0)\n        return;\n    }\n\n    this.queueFiltering(null, mutations);\n  }\n\n  apply(patterns) {\n    this.patterns = [];\n    for (let pattern of patterns) {\n      let selectors = this.parseSelector(pattern.selector);\n      if (selectors != null && selectors.length > 0)\n        this.patterns.push(new Pattern(selectors, pattern.text));\n    }\n\n    if (this.patterns.length > 0) {\n      this.queueFiltering();\n\n      let attributes = shouldObserveAttributes(this.patterns);\n      this.observer.observe(\n        this.document,\n        {\n          childList: true,\n          attributes,\n          attributeOldValue: attributes && !!testInfo,\n          characterData: shouldObserveCharacterData(this.patterns),\n          subtree: true\n        }\n      );\n      if (shouldObserveStyles(this.patterns)) {\n        let onLoad = this.onLoad.bind(this);\n        if (this.document.readyState === \"loading\")\n          this.document.addEventListener(\"DOMContentLoaded\", onLoad, true);\n        this.document.addEventListener(\"load\", onLoad, true);\n      }\n    }\n  }\n};\n","/*\n * This file is part of Adblock Plus <https://adblockplus.org/>,\n * Copyright (C) 2006-present eyeo GmbH\n *\n * Adblock Plus is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * Adblock Plus is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Adblock Plus.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/** @module */\n\n\"use strict\";\n\n/**\n * The maximum number of patterns that\n * `{@link module:patterns.compilePatterns compilePatterns()}` will compile\n * into regular expressions.\n * @type {number}\n */\nconst COMPILE_PATTERNS_MAX = 100;\n\n/**\n * Regular expression used to match the `^` suffix in an otherwise literal\n * pattern.\n * @type {RegExp}\n */\nlet separatorRegExp = /[\\x00-\\x24\\x26-\\x2C\\x2F\\x3A-\\x40\\x5B-\\x5E\\x60\\x7B-\\x7F]/;\n\nlet filterToRegExp =\n/**\n * Converts filter text into regular expression string\n * @param {string} text as in Filter()\n * @return {string} regular expression representation of filter text\n * @package\n */\nexports.filterToRegExp = function filterToRegExp(text) {\n  // remove multiple wildcards\n  text = text.replace(/\\*+/g, \"*\");\n\n  // remove leading wildcard\n  if (text[0] == \"*\")\n    text = text.substring(1);\n\n  // remove trailing wildcard\n  if (text[text.length - 1] == \"*\")\n    text = text.substring(0, text.length - 1);\n\n  return text\n    // remove anchors following separator placeholder\n    .replace(/\\^\\|$/, \"^\")\n    // escape special symbols\n    .replace(/\\W/g, \"\\\\$&\")\n    // replace wildcards by .*\n    .replace(/\\\\\\*/g, \".*\")\n    // process separator placeholders (all ANSI characters but alphanumeric\n    // characters and _%.-)\n    .replace(/\\\\\\^/g, `(?:${separatorRegExp.source}|$)`)\n    // process extended anchor at expression start\n    .replace(/^\\\\\\|\\\\\\|/, \"^[\\\\w\\\\-]+:\\\\/+(?:[^\\\\/]+\\\\.)?\")\n    // process anchor at expression start\n    .replace(/^\\\\\\|/, \"^\")\n    // process anchor at expression end\n    .replace(/\\\\\\|$/, \"$\");\n};\n\n/**\n * Regular expression used to match the `||` prefix in an otherwise literal\n * pattern.\n * @type {RegExp}\n */\nlet extendedAnchorRegExp = new RegExp(filterToRegExp(\"||\") + \"$\");\n\n/**\n * Regular expression for matching a keyword in a filter.\n * @type {RegExp}\n */\nlet keywordRegExp = /[^a-z0-9%*][a-z0-9%]{2,}(?=[^a-z0-9%*])/;\n\n/**\n * Regular expression for matching all keywords in a filter.\n * @type {RegExp}\n */\nlet allKeywordsRegExp = new RegExp(keywordRegExp, \"g\");\n\n/**\n * A `CompiledPatterns` object represents the compiled version of multiple URL\n * request patterns. It is returned by\n * `{@link module:patterns.compilePatterns compilePatterns()}`.\n */\nclass CompiledPatterns {\n  /**\n   * Creates an object with the given regular expressions for case-sensitive\n   * and case-insensitive matching respectively.\n   * @param {?RegExp} [caseSensitive]\n   * @param {?RegExp} [caseInsensitive]\n   * @private\n   */\n  constructor(caseSensitive, caseInsensitive) {\n    this._caseSensitive = caseSensitive;\n    this._caseInsensitive = caseInsensitive;\n  }\n\n  /**\n   * Tests whether the given URL request matches the patterns used to create\n   * this object.\n   * @param {module:url.URLRequest} request\n   * @returns {boolean}\n   */\n  test(request) {\n    return ((this._caseSensitive &&\n             this._caseSensitive.test(request.href)) ||\n            (this._caseInsensitive &&\n             this._caseInsensitive.test(request.lowerCaseHref)));\n  }\n}\n\n/**\n * Compiles patterns from the given filters into a single\n * `{@link module:patterns~CompiledPatterns CompiledPatterns}` object.\n *\n * @param {module:filterClasses.URLFilter|\n *         Set.<module:filterClasses.URLFilter>} filters\n *   The filters. If the number of filters exceeds\n *   `{@link module:patterns~COMPILE_PATTERNS_MAX COMPILE_PATTERNS_MAX}`, the\n *   function returns `null`.\n *\n * @returns {?module:patterns~CompiledPatterns}\n *\n * @package\n */\nexports.compilePatterns = function compilePatterns(filters) {\n  let list = Array.isArray(filters) ? filters : [filters];\n\n  // If the number of filters is too large, it may choke especially on low-end\n  // platforms. As a precaution, we refuse to compile. Ideally we would check\n  // the length of the regular expression source rather than the number of\n  // filters, but this is far more straightforward and practical.\n  if (list.length > COMPILE_PATTERNS_MAX)\n    return null;\n\n  let caseSensitive = \"\";\n  let caseInsensitive = \"\";\n\n  for (let filter of filters) {\n    let source = filter.urlPattern.regexpSource;\n\n    if (filter.matchCase)\n      caseSensitive += source + \"|\";\n    else\n      caseInsensitive += source + \"|\";\n  }\n\n  let caseSensitiveRegExp = null;\n  let caseInsensitiveRegExp = null;\n\n  try {\n    if (caseSensitive)\n      caseSensitiveRegExp = new RegExp(caseSensitive.slice(0, -1));\n\n    if (caseInsensitive)\n      caseInsensitiveRegExp = new RegExp(caseInsensitive.slice(0, -1));\n  }\n  catch (error) {\n    // It is possible in theory for the regular expression to be too large\n    // despite COMPILE_PATTERNS_MAX\n    return null;\n  }\n\n  return new CompiledPatterns(caseSensitiveRegExp, caseInsensitiveRegExp);\n};\n\n/**\n * Patterns for matching against URLs.\n *\n * Internally, this may be a RegExp or match directly against the\n * pattern for simple literal patterns.\n */\nexports.Pattern = class Pattern {\n  /**\n   * @param {string} pattern pattern that requests URLs should be\n   * matched against in filter text notation\n   * @param {bool} matchCase `true` if comparisons must be case\n   * sensitive\n   */\n  constructor(pattern, matchCase) {\n    this.matchCase = matchCase || false;\n\n    if (!this.matchCase)\n      pattern = pattern.toLowerCase();\n\n    if (pattern.length >= 2 &&\n        pattern[0] == \"/\" &&\n        pattern[pattern.length - 1] == \"/\") {\n      // The filter is a regular expression - convert it immediately to\n      // catch syntax errors\n      pattern = pattern.substring(1, pattern.length - 1);\n      this._regexp = new RegExp(pattern);\n    }\n    else {\n      // Patterns like /foo/bar/* exist so that they are not treated as regular\n      // expressions. We drop any superfluous wildcards here so our\n      // optimizations can kick in.\n      pattern = pattern.replace(/^\\*+/, \"\").replace(/\\*+$/, \"\");\n\n      // No need to convert this filter to regular expression yet, do it on\n      // demand\n      this.pattern = pattern;\n    }\n  }\n\n  /**\n   * Checks whether the pattern is a string of literal characters with\n   * no wildcards or any other special characters.\n   *\n   * If the pattern is prefixed with a `||` or suffixed with a `^` but otherwise\n   * contains no special characters, it is still considered to be a literal\n   * pattern.\n   *\n   * @returns {boolean}\n   */\n  isLiteralPattern() {\n    return typeof this.pattern !== \"undefined\" &&\n      !/[*^|]/.test(this.pattern.replace(/^\\|{1,2}/, \"\").replace(/[|^]$/, \"\"));\n  }\n\n  /**\n   * Regular expression to be used when testing against this pattern.\n   *\n   * null if the pattern is matched without using regular expressions.\n   * @type {RegExp}\n   */\n  get regexp() {\n    if (typeof this._regexp == \"undefined\") {\n      this._regexp = this.isLiteralPattern() ?\n        null : new RegExp(filterToRegExp(this.pattern));\n    }\n    return this._regexp;\n  }\n\n  /**\n   * Pattern in regular expression notation. This will have a value\n   * even if `regexp` returns null.\n   * @type {string}\n   */\n  get regexpSource() {\n    return this._regexp ? this._regexp.source : filterToRegExp(this.pattern);\n  }\n\n  /**\n   * Checks whether the given URL request matches this filter's pattern.\n   * @param {module:url.URLRequest} request The URL request to check.\n   * @returns {boolean} `true` if the URL request matches.\n   */\n  matchesLocation(request) {\n    let location = this.matchCase ? request.href : request.lowerCaseHref;\n    let regexp = this.regexp;\n    if (regexp)\n      return regexp.test(location);\n\n    let pattern = this.pattern;\n    let startsWithAnchor = pattern[0] == \"|\";\n    let startsWithExtendedAnchor = startsWithAnchor && pattern[1] == \"|\";\n    let endsWithSeparator = pattern[pattern.length - 1] == \"^\";\n    let endsWithAnchor = !endsWithSeparator &&\n        pattern[pattern.length - 1] == \"|\";\n\n    if (startsWithExtendedAnchor)\n      pattern = pattern.substr(2);\n    else if (startsWithAnchor)\n      pattern = pattern.substr(1);\n\n    if (endsWithSeparator || endsWithAnchor)\n      pattern = pattern.slice(0, -1);\n\n    let index = location.indexOf(pattern);\n\n    while (index != -1) {\n      // The \"||\" prefix requires that the text that follows does not start\n      // with a forward slash.\n      if ((startsWithExtendedAnchor ?\n           location[index] != \"/\" &&\n           extendedAnchorRegExp.test(location.substring(0, index)) :\n           startsWithAnchor ?\n           index == 0 :\n           true) &&\n          (endsWithSeparator ?\n           !location[index + pattern.length] ||\n           separatorRegExp.test(location[index + pattern.length]) :\n           endsWithAnchor ?\n           index == location.length - pattern.length :\n           true))\n        return true;\n\n      if (pattern == \"\")\n        return true;\n\n      index = location.indexOf(pattern, index + 1);\n    }\n\n    return false;\n  }\n\n  /**\n   * Checks whether the pattern has keywords\n   * @returns {boolean}\n   */\n  hasKeywords() {\n    return this.pattern && keywordRegExp.test(this.pattern);\n  }\n\n  /**\n   * Finds all keywords that could be associated with this pattern\n   * @returns {string[]}\n   */\n  keywordCandidates() {\n    if (!this.pattern)\n      return null;\n    return this.pattern.toLowerCase().match(allKeywordsRegExp);\n  }\n};\n","/* webextension-polyfill - v0.8.0 - Tue Apr 20 2021 11:27:38 */\n/* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n/* vim: set sts=2 sw=2 et tw=80: */\n/* This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n\"use strict\";\n\nif (typeof browser === \"undefined\" || Object.getPrototypeOf(browser) !== Object.prototype) {\n  const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = \"The message port closed before a response was received.\";\n  const SEND_RESPONSE_DEPRECATION_WARNING = \"Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)\";\n\n  // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n  // optimization for Firefox. Since Spidermonkey does not fully parse the\n  // contents of a function until the first time it's called, and since it will\n  // never actually need to be called, this allows the polyfill to be included\n  // in Firefox nearly for free.\n  const wrapAPIs = extensionAPIs => {\n    // NOTE: apiMetadata is associated to the content of the api-metadata.json file\n    // at build time by replacing the following \"include\" with the content of the\n    // JSON file.\n    const apiMetadata = {\n      \"alarms\": {\n        \"clear\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"clearAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"bookmarks\": {\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getChildren\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getRecent\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getSubTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTree\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeTree\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"browserAction\": {\n        \"disable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"enable\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"getBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"openPopup\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setBadgeBackgroundColor\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setBadgeText\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"browsingData\": {\n        \"remove\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"removeCache\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCookies\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeDownloads\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFormData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeHistory\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeLocalStorage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePasswords\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removePluginData\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"settings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"commands\": {\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"contextMenus\": {\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"cookies\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAllCookieStores\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"set\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"devtools\": {\n        \"inspectedWindow\": {\n          \"eval\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2,\n            \"singleCallbackArg\": false\n          }\n        },\n        \"panels\": {\n          \"create\": {\n            \"minArgs\": 3,\n            \"maxArgs\": 3,\n            \"singleCallbackArg\": true\n          },\n          \"elements\": {\n            \"createSidebarPane\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          }\n        }\n      },\n      \"downloads\": {\n        \"cancel\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"download\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"erase\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFileIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"open\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"pause\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeFile\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"resume\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"extension\": {\n        \"isAllowedFileSchemeAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"isAllowedIncognitoAccess\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"history\": {\n        \"addUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"deleteRange\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"deleteUrl\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getVisits\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"search\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"i18n\": {\n        \"detectLanguage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAcceptLanguages\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"identity\": {\n        \"launchWebAuthFlow\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"idle\": {\n        \"queryState\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"management\": {\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"setEnabled\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"uninstallSelf\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"notifications\": {\n        \"clear\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPermissionLevel\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      },\n      \"pageAction\": {\n        \"getPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"hide\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setIcon\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"setPopup\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"setTitle\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        },\n        \"show\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1,\n          \"fallbackToNoCallback\": true\n        }\n      },\n      \"permissions\": {\n        \"contains\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"request\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"runtime\": {\n        \"getBackgroundPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getPlatformInfo\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"openOptionsPage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"requestUpdateCheck\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"sendMessage\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 3\n        },\n        \"sendNativeMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"setUninstallURL\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"sessions\": {\n        \"getDevices\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getRecentlyClosed\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"restore\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        }\n      },\n      \"storage\": {\n        \"local\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"managed\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"sync\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getBytesInUse\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        }\n      },\n      \"tabs\": {\n        \"captureVisibleTab\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"create\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"detectLanguage\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"discard\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"duplicate\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"executeScript\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        },\n        \"getZoom\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getZoomSettings\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goBack\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"goForward\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"highlight\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"insertCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"move\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        },\n        \"query\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"reload\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 2\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"removeCSS\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"sendMessage\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 3\n        },\n        \"setZoom\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"setZoomSettings\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"update\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        }\n      },\n      \"topSites\": {\n        \"get\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"webNavigation\": {\n        \"getAllFrames\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"getFrame\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        }\n      },\n      \"webRequest\": {\n        \"handlerBehaviorChanged\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 0\n        }\n      },\n      \"windows\": {\n        \"create\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"get\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 2\n        },\n        \"getAll\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getCurrent\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"getLastFocused\": {\n          \"minArgs\": 0,\n          \"maxArgs\": 1\n        },\n        \"remove\": {\n          \"minArgs\": 1,\n          \"maxArgs\": 1\n        },\n        \"update\": {\n          \"minArgs\": 2,\n          \"maxArgs\": 2\n        }\n      }\n    };\n\n    if (Object.keys(apiMetadata).length === 0) {\n      throw new Error(\"api-metadata.json has not been included in browser-polyfill\");\n    }\n\n    /**\n     * A WeakMap subclass which creates and stores a value for any key which does\n     * not exist when accessed, but behaves exactly as an ordinary WeakMap\n     * otherwise.\n     *\n     * @param {function} createItem\n     *        A function which will be called in order to create the value for any\n     *        key which does not exist, the first time it is accessed. The\n     *        function receives, as its only argument, the key being created.\n     */\n    class DefaultWeakMap extends WeakMap {\n      constructor(createItem, items = undefined) {\n        super(items);\n        this.createItem = createItem;\n      }\n\n      get(key) {\n        if (!this.has(key)) {\n          this.set(key, this.createItem(key));\n        }\n\n        return super.get(key);\n      }\n    }\n\n    /**\n     * Returns true if the given object is an object with a `then` method, and can\n     * therefore be assumed to behave as a Promise.\n     *\n     * @param {*} value The value to test.\n     * @returns {boolean} True if the value is thenable.\n     */\n    const isThenable = value => {\n      return value && typeof value === \"object\" && typeof value.then === \"function\";\n    };\n\n    /**\n     * Creates and returns a function which, when called, will resolve or reject\n     * the given promise based on how it is called:\n     *\n     * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n     *   the promise is rejected with that value.\n     * - If the function is called with exactly one argument, the promise is\n     *   resolved to that value.\n     * - Otherwise, the promise is resolved to an array containing all of the\n     *   function's arguments.\n     *\n     * @param {object} promise\n     *        An object containing the resolution and rejection functions of a\n     *        promise.\n     * @param {function} promise.resolve\n     *        The promise's resolution function.\n     * @param {function} promise.reject\n     *        The promise's rejection function.\n     * @param {object} metadata\n     *        Metadata about the wrapped method which has created the callback.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function}\n     *        The generated callback function.\n     */\n    const makeCallback = (promise, metadata) => {\n      return (...callbackArgs) => {\n        if (extensionAPIs.runtime.lastError) {\n          promise.reject(new Error(extensionAPIs.runtime.lastError.message));\n        } else if (metadata.singleCallbackArg ||\n                   (callbackArgs.length <= 1 && metadata.singleCallbackArg !== false)) {\n          promise.resolve(callbackArgs[0]);\n        } else {\n          promise.resolve(callbackArgs);\n        }\n      };\n    };\n\n    const pluralizeArguments = (numArgs) => numArgs == 1 ? \"argument\" : \"arguments\";\n\n    /**\n     * Creates a wrapper function for a method with the given name and metadata.\n     *\n     * @param {string} name\n     *        The name of the method which is being wrapped.\n     * @param {object} metadata\n     *        Metadata about the method being wrapped.\n     * @param {integer} metadata.minArgs\n     *        The minimum number of arguments which must be passed to the\n     *        function. If called with fewer than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {integer} metadata.maxArgs\n     *        The maximum number of arguments which may be passed to the\n     *        function. If called with more than this number of arguments, the\n     *        wrapper will raise an exception.\n     * @param {boolean} metadata.singleCallbackArg\n     *        Whether or not the promise is resolved with only the first\n     *        argument of the callback, alternatively an array of all the\n     *        callback arguments is resolved. By default, if the callback\n     *        function is invoked with only a single argument, that will be\n     *        resolved to the promise, while all arguments will be resolved as\n     *        an array if multiple are given.\n     *\n     * @returns {function(object, ...*)}\n     *       The generated wrapper function.\n     */\n    const wrapAsyncFunction = (name, metadata) => {\n      return function asyncFunctionWrapper(target, ...args) {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          if (metadata.fallbackToNoCallback) {\n            // This API method has currently no callback on Chrome, but it return a promise on Firefox,\n            // and so the polyfill will try to call it with a callback first, and it will fallback\n            // to not passing the callback if the first call fails.\n            try {\n              target[name](...args, makeCallback({resolve, reject}, metadata));\n            } catch (cbError) {\n              console.warn(`${name} API method doesn't seem to support the callback parameter, ` +\n                           \"falling back to call it without a callback: \", cbError);\n\n              target[name](...args);\n\n              // Update the API method metadata, so that the next API calls will not try to\n              // use the unsupported callback anymore.\n              metadata.fallbackToNoCallback = false;\n              metadata.noCallback = true;\n\n              resolve();\n            }\n          } else if (metadata.noCallback) {\n            target[name](...args);\n            resolve();\n          } else {\n            target[name](...args, makeCallback({resolve, reject}, metadata));\n          }\n        });\n      };\n    };\n\n    /**\n     * Wraps an existing method of the target object, so that calls to it are\n     * intercepted by the given wrapper function. The wrapper function receives,\n     * as its first argument, the original `target` object, followed by each of\n     * the arguments passed to the original method.\n     *\n     * @param {object} target\n     *        The original target object that the wrapped method belongs to.\n     * @param {function} method\n     *        The method being wrapped. This is used as the target of the Proxy\n     *        object which is created to wrap the method.\n     * @param {function} wrapper\n     *        The wrapper function which is called in place of a direct invocation\n     *        of the wrapped method.\n     *\n     * @returns {Proxy<function>}\n     *        A Proxy object for the given method, which invokes the given wrapper\n     *        method in its place.\n     */\n    const wrapMethod = (target, method, wrapper) => {\n      return new Proxy(method, {\n        apply(targetMethod, thisObj, args) {\n          return wrapper.call(thisObj, target, ...args);\n        },\n      });\n    };\n\n    let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n\n    /**\n     * Wraps an object in a Proxy which intercepts and wraps certain methods\n     * based on the given `wrappers` and `metadata` objects.\n     *\n     * @param {object} target\n     *        The target object to wrap.\n     *\n     * @param {object} [wrappers = {}]\n     *        An object tree containing wrapper functions for special cases. Any\n     *        function present in this object tree is called in place of the\n     *        method in the same location in the `target` object tree. These\n     *        wrapper methods are invoked as described in {@see wrapMethod}.\n     *\n     * @param {object} [metadata = {}]\n     *        An object tree containing metadata used to automatically generate\n     *        Promise-based wrapper functions for asynchronous. Any function in\n     *        the `target` object tree which has a corresponding metadata object\n     *        in the same location in the `metadata` tree is replaced with an\n     *        automatically-generated wrapper function, as described in\n     *        {@see wrapAsyncFunction}\n     *\n     * @returns {Proxy<object>}\n     */\n    const wrapObject = (target, wrappers = {}, metadata = {}) => {\n      let cache = Object.create(null);\n      let handlers = {\n        has(proxyTarget, prop) {\n          return prop in target || prop in cache;\n        },\n\n        get(proxyTarget, prop, receiver) {\n          if (prop in cache) {\n            return cache[prop];\n          }\n\n          if (!(prop in target)) {\n            return undefined;\n          }\n\n          let value = target[prop];\n\n          if (typeof value === \"function\") {\n            // This is a method on the underlying object. Check if we need to do\n            // any wrapping.\n\n            if (typeof wrappers[prop] === \"function\") {\n              // We have a special-case wrapper for this method.\n              value = wrapMethod(target, target[prop], wrappers[prop]);\n            } else if (hasOwnProperty(metadata, prop)) {\n              // This is an async method that we have metadata for. Create a\n              // Promise wrapper for it.\n              let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n              value = wrapMethod(target, target[prop], wrapper);\n            } else {\n              // This is a method that we don't know or care about. Return the\n              // original method, bound to the underlying object.\n              value = value.bind(target);\n            }\n          } else if (typeof value === \"object\" && value !== null &&\n                     (hasOwnProperty(wrappers, prop) ||\n                      hasOwnProperty(metadata, prop))) {\n            // This is an object that we need to do some wrapping for the children\n            // of. Create a sub-object wrapper for it with the appropriate child\n            // metadata.\n            value = wrapObject(value, wrappers[prop], metadata[prop]);\n          } else if (hasOwnProperty(metadata, \"*\")) {\n            // Wrap all properties in * namespace.\n            value = wrapObject(value, wrappers[prop], metadata[\"*\"]);\n          } else {\n            // We don't need to do any wrapping for this property,\n            // so just forward all access to the underlying object.\n            Object.defineProperty(cache, prop, {\n              configurable: true,\n              enumerable: true,\n              get() {\n                return target[prop];\n              },\n              set(value) {\n                target[prop] = value;\n              },\n            });\n\n            return value;\n          }\n\n          cache[prop] = value;\n          return value;\n        },\n\n        set(proxyTarget, prop, value, receiver) {\n          if (prop in cache) {\n            cache[prop] = value;\n          } else {\n            target[prop] = value;\n          }\n          return true;\n        },\n\n        defineProperty(proxyTarget, prop, desc) {\n          return Reflect.defineProperty(cache, prop, desc);\n        },\n\n        deleteProperty(proxyTarget, prop) {\n          return Reflect.deleteProperty(cache, prop);\n        },\n      };\n\n      // Per contract of the Proxy API, the \"get\" proxy handler must return the\n      // original value of the target if that value is declared read-only and\n      // non-configurable. For this reason, we create an object with the\n      // prototype set to `target` instead of using `target` directly.\n      // Otherwise we cannot return a custom object for APIs that\n      // are declared read-only and non-configurable, such as `chrome.devtools`.\n      //\n      // The proxy handlers themselves will still use the original `target`\n      // instead of the `proxyTarget`, so that the methods and properties are\n      // dereferenced via the original targets.\n      let proxyTarget = Object.create(target);\n      return new Proxy(proxyTarget, handlers);\n    };\n\n    /**\n     * Creates a set of wrapper functions for an event object, which handles\n     * wrapping of listener functions that those messages are passed.\n     *\n     * A single wrapper is created for each listener function, and stored in a\n     * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n     * retrieve the original wrapper, so that  attempts to remove a\n     * previously-added listener work as expected.\n     *\n     * @param {DefaultWeakMap<function, function>} wrapperMap\n     *        A DefaultWeakMap object which will create the appropriate wrapper\n     *        for a given listener function when one does not exist, and retrieve\n     *        an existing one when it does.\n     *\n     * @returns {object}\n     */\n    const wrapEvent = wrapperMap => ({\n      addListener(target, listener, ...args) {\n        target.addListener(wrapperMap.get(listener), ...args);\n      },\n\n      hasListener(target, listener) {\n        return target.hasListener(wrapperMap.get(listener));\n      },\n\n      removeListener(target, listener) {\n        target.removeListener(wrapperMap.get(listener));\n      },\n    });\n\n    const onRequestFinishedWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps an onRequestFinished listener function so that it will return a\n       * `getContent()` property which returns a `Promise` rather than using a\n       * callback API.\n       *\n       * @param {object} req\n       *        The HAR entry object representing the network request.\n       */\n      return function onRequestFinished(req) {\n        const wrappedReq = wrapObject(req, {} /* wrappers */, {\n          getContent: {\n            minArgs: 0,\n            maxArgs: 0,\n          },\n        });\n        listener(wrappedReq);\n      };\n    });\n\n    // Keep track if the deprecation warning has been logged at least once.\n    let loggedSendResponseDeprecationWarning = false;\n\n    const onMessageWrappers = new DefaultWeakMap(listener => {\n      if (typeof listener !== \"function\") {\n        return listener;\n      }\n\n      /**\n       * Wraps a message listener function so that it may send responses based on\n       * its return value, rather than by returning a sentinel value and calling a\n       * callback. If the listener function returns a Promise, the response is\n       * sent when the promise either resolves or rejects.\n       *\n       * @param {*} message\n       *        The message sent by the other end of the channel.\n       * @param {object} sender\n       *        Details about the sender of the message.\n       * @param {function(*)} sendResponse\n       *        A callback which, when called with an arbitrary argument, sends\n       *        that value as a response.\n       * @returns {boolean}\n       *        True if the wrapped listener returned a Promise, which will later\n       *        yield a response. False otherwise.\n       */\n      return function onMessage(message, sender, sendResponse) {\n        let didCallSendResponse = false;\n\n        let wrappedSendResponse;\n        let sendResponsePromise = new Promise(resolve => {\n          wrappedSendResponse = function(response) {\n            if (!loggedSendResponseDeprecationWarning) {\n              console.warn(SEND_RESPONSE_DEPRECATION_WARNING, new Error().stack);\n              loggedSendResponseDeprecationWarning = true;\n            }\n            didCallSendResponse = true;\n            resolve(response);\n          };\n        });\n\n        let result;\n        try {\n          result = listener(message, sender, wrappedSendResponse);\n        } catch (err) {\n          result = Promise.reject(err);\n        }\n\n        const isResultThenable = result !== true && isThenable(result);\n\n        // If the listener didn't returned true or a Promise, or called\n        // wrappedSendResponse synchronously, we can exit earlier\n        // because there will be no response sent from this listener.\n        if (result !== true && !isResultThenable && !didCallSendResponse) {\n          return false;\n        }\n\n        // A small helper to send the message if the promise resolves\n        // and an error if the promise rejects (a wrapped sendMessage has\n        // to translate the message into a resolved promise or a rejected\n        // promise).\n        const sendPromisedResult = (promise) => {\n          promise.then(msg => {\n            // send the message value.\n            sendResponse(msg);\n          }, error => {\n            // Send a JSON representation of the error if the rejected value\n            // is an instance of error, or the object itself otherwise.\n            let message;\n            if (error && (error instanceof Error ||\n                typeof error.message === \"string\")) {\n              message = error.message;\n            } else {\n              message = \"An unexpected error occurred\";\n            }\n\n            sendResponse({\n              __mozWebExtensionPolyfillReject__: true,\n              message,\n            });\n          }).catch(err => {\n            // Print an error on the console if unable to send the response.\n            console.error(\"Failed to send onMessage rejected reply\", err);\n          });\n        };\n\n        // If the listener returned a Promise, send the resolved value as a\n        // result, otherwise wait the promise related to the wrappedSendResponse\n        // callback to resolve and send it as a response.\n        if (isResultThenable) {\n          sendPromisedResult(result);\n        } else {\n          sendPromisedResult(sendResponsePromise);\n        }\n\n        // Let Chrome know that the listener is replying.\n        return true;\n      };\n    });\n\n    const wrappedSendMessageCallback = ({reject, resolve}, reply) => {\n      if (extensionAPIs.runtime.lastError) {\n        // Detect when none of the listeners replied to the sendMessage call and resolve\n        // the promise to undefined as in Firefox.\n        // See https://github.com/mozilla/webextension-polyfill/issues/130\n        if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {\n          resolve();\n        } else {\n          reject(new Error(extensionAPIs.runtime.lastError.message));\n        }\n      } else if (reply && reply.__mozWebExtensionPolyfillReject__) {\n        // Convert back the JSON representation of the error into\n        // an Error instance.\n        reject(new Error(reply.message));\n      } else {\n        resolve(reply);\n      }\n    };\n\n    const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {\n      if (args.length < metadata.minArgs) {\n        throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      if (args.length > metadata.maxArgs) {\n        throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n      }\n\n      return new Promise((resolve, reject) => {\n        const wrappedCb = wrappedSendMessageCallback.bind(null, {resolve, reject});\n        args.push(wrappedCb);\n        apiNamespaceObj.sendMessage(...args);\n      });\n    };\n\n    const staticWrappers = {\n      devtools: {\n        network: {\n          onRequestFinished: wrapEvent(onRequestFinishedWrappers),\n        },\n      },\n      runtime: {\n        onMessage: wrapEvent(onMessageWrappers),\n        onMessageExternal: wrapEvent(onMessageWrappers),\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 1, maxArgs: 3}),\n      },\n      tabs: {\n        sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {minArgs: 2, maxArgs: 3}),\n      },\n    };\n    const settingMetadata = {\n      clear: {minArgs: 1, maxArgs: 1},\n      get: {minArgs: 1, maxArgs: 1},\n      set: {minArgs: 1, maxArgs: 1},\n    };\n    apiMetadata.privacy = {\n      network: {\"*\": settingMetadata},\n      services: {\"*\": settingMetadata},\n      websites: {\"*\": settingMetadata},\n    };\n\n    return wrapObject(extensionAPIs, staticWrappers, apiMetadata);\n  };\n\n  if (typeof chrome != \"object\" || !chrome || !chrome.runtime || !chrome.runtime.id) {\n    throw new Error(\"This script should only be loaded in a browser extension.\");\n  }\n\n  // The build process adds a UMD wrapper around this file, which makes the\n  // `module` variable available.\n  module.exports = wrapAPIs(chrome);\n} else {\n  module.exports = browser;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","/*\n * This file is part of eyeo's Web Extension Ad Blocking Toolkit (EWE),\n * Copyright (C) 2006-present eyeo GmbH\n *\n * EWE is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * EWE is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with EWE.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nconst ERROR_NO_CONNECTION = \"Could not establish connection. \" +\n      \"Receiving end does not exist.\";\nconst ERROR_CLOSED_CONNECTION = \"A listener indicated an asynchronous \" +\n      \"response by returning true, but the message channel closed before a \" +\n      \"response was received\";\n\nexport const ERROR_DUPLICATE_FILTERS = \"storage_duplicate_filters\";\nexport const ERROR_FILTER_NOT_FOUND = \"filter_not_found\";\nexport const ERROR_TOO_MANY_FILTERS = \"too_many_filters\";\n\nexport function ignoreNoConnectionError(promise) {\n  return promise.catch(error => {\n    if (typeof error == \"object\" &&\n        (error.message == ERROR_NO_CONNECTION ||\n         error.message == ERROR_CLOSED_CONNECTION))\n      return;\n\n    throw error;\n  });\n}\n","/*\n * This file is part of eyeo's Web Extension Ad Blocking Toolkit (EWE),\n * Copyright (C) 2006-present eyeo GmbH\n *\n * EWE is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * EWE is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with EWE.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport browser from \"webextension-polyfill\";\nimport {ignoreNoConnectionError} from \"../errors.js\";\n\nlet collapsedSelectors = new Set();\nlet observers = new WeakMap();\n\nfunction getURLFromElement(element) {\n  if (element.localName == \"object\") {\n    if (element.data)\n      return element.data;\n\n    for (let child of element.children) {\n      if (child.localName == \"param\" && child.name == \"movie\" && child.value)\n        return new URL(child.value, document.baseURI).href;\n    }\n\n    return null;\n  }\n\n  return element.currentSrc || element.src;\n}\n\nfunction getSelectorForBlockedElement(element) {\n  // Setting the \"display\" CSS property to \"none\" doesn't have any effect on\n  // <frame> elements (in framesets). So we have to hide it inline through\n  // the \"visibility\" CSS property.\n  if (element.localName == \"frame\")\n    return null;\n\n  // If the <video> or <audio> element contains any <source> children,\n  // we cannot address it in CSS by the source URL; in that case we\n  // don't \"collapse\" it using a CSS selector but rather hide it directly by\n  // setting the style=\"...\" attribute.\n  if (element.localName == \"video\" || element.localName == \"audio\") {\n    for (let child of element.children) {\n      if (child.localName == \"source\")\n        return null;\n    }\n  }\n\n  let selector = \"\";\n  for (let attr of [\"src\", \"srcset\"]) {\n    let value = element.getAttribute(attr);\n    if (value && attr in element)\n      selector += \"[\" + attr + \"=\" + CSS.escape(value) + \"]\";\n  }\n\n  return selector ? element.localName + selector : null;\n}\n\nexport function hideElement(element, properties) {\n  let {style} = element;\n\n  if (!properties) {\n    if (element.localName == \"frame\")\n      properties = [[\"visibility\", \"hidden\"]];\n    else\n      properties = [[\"display\", \"none\"]];\n  }\n\n  for (let [key, value] of properties)\n    style.setProperty(key, value, \"important\");\n\n  if (observers.has(element))\n    observers.get(element).disconnect();\n\n  let observer = new MutationObserver(() => {\n    for (let [key, value] of properties) {\n      if (style.getPropertyValue(key) != value ||\n          style.getPropertyPriority(key) != \"important\")\n        style.setProperty(key, value, \"important\");\n    }\n  });\n  observer.observe(\n    element, {\n      attributes: true,\n      attributeFilter: [\"style\"]\n    }\n  );\n  observers.set(element, observer);\n}\n\nexport function unhideElement(element) {\n  let observer = observers.get(element);\n  if (observer) {\n    observer.disconnect();\n    observers.delete(element);\n  }\n\n  let property = element.localName == \"frame\" ? \"visibility\" : \"display\";\n  element.style.removeProperty(property);\n}\n\nfunction collapseElement(element) {\n  let selector = getSelectorForBlockedElement(element);\n  if (!selector) {\n    hideElement(element);\n    return;\n  }\n\n  if (!collapsedSelectors.has(selector)) {\n    ignoreNoConnectionError(\n      browser.runtime.sendMessage({\n        type: \"ewe:inject-css\",\n        selector\n      })\n    );\n    collapsedSelectors.add(selector);\n  }\n}\n\nfunction hideInAboutBlankFrames(selector, urls) {\n  // Resources (e.g. images) loaded into about:blank frames\n  // are (sometimes) loaded with the frameId of the main_frame.\n  for (let frame of document.querySelectorAll(\"iframe[src='about:blank']\")) {\n    if (!frame.contentDocument)\n      continue;\n\n    for (let element of frame.contentDocument.querySelectorAll(selector)) {\n      // Use hideElement, because we don't have the correct frameId\n      // for the \"ewe:inject-css\" message.\n      if (urls.has(getURLFromElement(element)))\n        hideElement(element);\n    }\n  }\n}\n\nexport function startElementCollapsing() {\n  let deferred = null;\n\n  browser.runtime.onMessage.addListener((message, sender) => {\n    if (!message || message.type != \"ewe:collapse\")\n      return false;\n\n    if (document.readyState == \"loading\") {\n      if (!deferred) {\n        deferred = new Map();\n        document.addEventListener(\"DOMContentLoaded\", () => {\n          for (let [selector, urls] of deferred) {\n            for (let element of document.querySelectorAll(selector)) {\n              if (urls.has(getURLFromElement(element)))\n                collapseElement(element);\n            }\n\n            hideInAboutBlankFrames(selector, urls);\n          }\n\n          deferred = null;\n        });\n      }\n\n      let urls = deferred.get(message.selector) || new Set();\n      deferred.set(message.selector, urls);\n      urls.add(message.url);\n    }\n    else {\n      for (let element of document.querySelectorAll(message.selector)) {\n        if (getURLFromElement(element) == message.url)\n          collapseElement(element);\n      }\n\n      hideInAboutBlankFrames(message.selector, new Set([message.url]));\n    }\n    return true;\n  });\n}\n","/*\n * This file is part of eyeo's Web Extension Ad Blocking Toolkit (EWE),\n * Copyright (C) 2006-present eyeo GmbH\n *\n * EWE is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * EWE is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with EWE.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport browser from \"webextension-polyfill\";\nimport {ignoreNoConnectionError} from \"../errors.js\";\n\nconst MAX_ERROR_THRESHOLD = 30;\nconst MAX_QUEUED_EVENTS = 20;\nconst EVENT_INTERVAL_MS = 100;\n\nlet errorCount = 0;\nlet eventProcessingInterval = null;\nlet eventQueue = [];\n\nfunction isEventTrusted(event) {\n  return Object.getPrototypeOf(event) === CustomEvent.prototype &&\n    !Object.hasOwnProperty.call(event, \"detail\");\n}\n\nasync function allowlistDomain(event) {\n  if (!isEventTrusted(event))\n    return false;\n\n  return ignoreNoConnectionError(\n    browser.runtime.sendMessage({\n      type: \"ewe:allowlist-page\",\n      timestamp: event.detail.timestamp,\n      signature: event.detail.signature\n    })\n  );\n}\n\nasync function processNextEvent() {\n  let event = eventQueue.shift();\n  if (event) {\n    try {\n      let allowlistingResult = await allowlistDomain(event);\n      if (allowlistingResult === true) {\n        document.dispatchEvent(new Event(\"domain_allowlisting_success\"));\n        stopOneClickAllowlisting();\n      }\n      else {\n        throw new Error(\"Domain allowlisting rejected\");\n      }\n    }\n    catch (e) {\n      errorCount++;\n      if (errorCount >= MAX_ERROR_THRESHOLD)\n        stopOneClickAllowlisting();\n    }\n  }\n\n  if (!eventQueue.length)\n    stopProcessingInterval();\n}\n\nfunction onDomainAllowlistingRequest(event) {\n  if (eventQueue.length >= MAX_QUEUED_EVENTS)\n    return;\n\n  eventQueue.push(event);\n  startProcessingInterval();\n}\n\nfunction startProcessingInterval() {\n  if (!eventProcessingInterval) {\n    processNextEvent();\n    eventProcessingInterval = setInterval(processNextEvent, EVENT_INTERVAL_MS);\n  }\n}\n\nfunction stopProcessingInterval() {\n  clearInterval(eventProcessingInterval);\n  eventProcessingInterval = null;\n}\n\nexport function stopOneClickAllowlisting() {\n  document.removeEventListener(\"domain_allowlisting_request\",\n                               onDomainAllowlistingRequest, true);\n  eventQueue = [];\n  stopProcessingInterval();\n}\n\nexport function startOneClickAllowlisting() {\n  document.addEventListener(\"domain_allowlisting_request\",\n                            onDomainAllowlistingRequest, true);\n}\n","/*\n * This file is part of eyeo's Web Extension Ad Blocking Toolkit (EWE),\n * Copyright (C) 2006-present eyeo GmbH\n *\n * EWE is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * EWE is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with EWE.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport browser from \"webextension-polyfill\";\nimport {ignoreNoConnectionError} from \"../errors.js\";\n\nexport class ElementHidingTracer {\n  constructor(selectors) {\n    this.selectors = new Map(selectors);\n\n    this.observer = new MutationObserver(() => {\n      this.observer.disconnect();\n      setTimeout(() => this.trace(), 1000);\n    });\n\n    if (document.readyState == \"loading\")\n      document.addEventListener(\"DOMContentLoaded\", () => this.trace());\n    else\n      this.trace();\n  }\n\n  log(filters, selectors = []) {\n    ignoreNoConnectionError(browser.runtime.sendMessage(\n      {type: \"ewe:trace-elem-hide\", filters, selectors}\n    ));\n  }\n\n  trace() {\n    let filters = [];\n    let selectors = [];\n\n    for (let [selector, filter] of this.selectors) {\n      if (document.querySelector(selector)) {\n        this.selectors.delete(selector);\n        if (filter)\n          filters.push(filter);\n        else\n          selectors.push(selector);\n      }\n    }\n\n    if (filters.length > 0 || selectors.length > 0)\n      this.log(filters, selectors);\n\n    this.observer.observe(document, {childList: true,\n                                     attributes: true,\n                                     subtree: true});\n  }\n}\n","/*\n * This file is part of eyeo's Web Extension Ad Blocking Toolkit (EWE),\n * Copyright (C) 2006-present eyeo GmbH\n *\n * EWE is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * EWE is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with EWE.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport browser from \"webextension-polyfill\";\n\nimport {ElemHideEmulation}\n  from \"adblockpluscore/lib/content/elemHideEmulation.js\";\n\nimport {ignoreNoConnectionError} from \"../errors.js\";\nimport {startElementCollapsing, hideElement, unhideElement}\n  from \"./element-collapsing.js\";\nimport {startOneClickAllowlisting} from \"./allowlisting.js\";\nimport {ElementHidingTracer} from \"./element-hiding-tracer.js\";\nimport {handleSubscribeLinks} from \"./subscribe-links.js\";\n\nasync function initContentFeatures() {\n  let response = await ignoreNoConnectionError(\n    browser.runtime.sendMessage({type: \"ewe:content-hello\"})\n  );\n\n  if (!response)\n    return;\n\n  let tracer;\n  if (response.tracedSelectors)\n    tracer = new ElementHidingTracer(response.tracedSelectors);\n\n  if (response.emulatedPatterns.length > 0) {\n    let elemHideEmulation = new ElemHideEmulation((elements, filters) => {\n      for (let element of elements)\n        hideElement(element, response.cssProperties);\n\n      if (tracer)\n        tracer.log(filters);\n    }, elements => {\n      for (let element of elements)\n        unhideElement(element);\n    });\n    elemHideEmulation.apply(response.emulatedPatterns);\n  }\n\n  if (response.subscribeLinks)\n    handleSubscribeLinks();\n}\n\nstartElementCollapsing();\nstartOneClickAllowlisting();\ninitContentFeatures();\n","/*\n * This file is part of eyeo's Web Extension Ad Blocking Toolkit (EWE),\n * Copyright (C) 2006-present eyeo GmbH\n *\n * EWE is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * EWE is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with EWE.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport browser from \"webextension-polyfill\";\nimport {ignoreNoConnectionError} from \"../errors.js\";\n\nexport function handleSubscribeLinks() {\n  document.addEventListener(\"click\", event => {\n    if (event.button == 2 || !event.isTrusted)\n      return;\n\n    let link = event.target;\n    while (!(link instanceof HTMLAnchorElement)) {\n      link = link.parentNode;\n\n      if (!link)\n        return;\n    }\n\n    let queryString = null;\n    if (link.protocol == \"http:\" || link.protocol == \"https:\") {\n      if (link.host == \"subscribe.adblockplus.org\" && link.pathname == \"/\")\n        queryString = link.search.substr(1);\n    }\n    else {\n      // Firefox doesn't seem to populate the \"search\" property for\n      // links with non-standard URL schemes so we need to extract the query\n      // string manually.\n      let match = /^abp:\\/*subscribe\\/*\\?(.*)/i.exec(link.href);\n      if (match)\n        queryString = match[1];\n    }\n\n    if (!queryString)\n      return;\n\n    let title = null;\n    let url = null;\n    for (let param of queryString.split(\"&\")) {\n      let parts = param.split(\"=\", 2);\n      if (parts.length != 2 || !/\\S/.test(parts[1]))\n        continue;\n      switch (parts[0]) {\n        case \"title\":\n          title = decodeURIComponent(parts[1]);\n          break;\n        case \"location\":\n          url = decodeURIComponent(parts[1]);\n          break;\n      }\n    }\n    if (!url)\n      return;\n\n    if (!title)\n      title = url;\n\n    title = title.trim();\n    url = url.trim();\n    if (!/^(https?|ftp):/.test(url))\n      return;\n\n    ignoreNoConnectionError(\n      browser.runtime.sendMessage({type: \"ewe:subscribe-link-clicked\",\n                                   title, url})\n    );\n\n    event.preventDefault();\n    event.stopPropagation();\n  }, true);\n}\n"],"sourceRoot":""}